<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Football Auction Slide</title>
    <!-- Use Tailwind CSS for a clean, responsive design -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c;
            background-size: cover;
            background-position: center center;
            background-attachment: fixed;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden; /* Prevent overflow during animation */
        }
        .action-button {
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-weight: 600;
            color: #ffffff;
            transition-property: background-color, transform, box-shadow;
            transition-duration: 300ms;
            transition-timing-function: ease-in-out;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .action-button:active {
            transform: translateY(0);
        }
        .prev-button {
            background-color: #6b7280;
        }
        .prev-button:hover {
            background-color: #4b5563;
        }
        .next-button {
            background-color: #f59e0b;
        }
        .next-button:hover {
            background-color: #d97706;
        }
        #loading-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #ffffff;
            font-size: 1.25rem;
            font-weight: 600;
        }
        .glass-card {
            background: rgba(45, 55, 72, 0.6);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        /* Animation Keyframes */
        @keyframes slideInNext {
            from {
                transform: translateX(100%) scale(0.9);
                opacity: 0;
            }
            to {
                transform: translateX(0) scale(1);
                opacity: 1;
            }
        }
        @keyframes slideInPrev {
            from {
                transform: translateX(-100%) scale(0.9);
                opacity: 0;
            }
            to {
                transform: translateX(0) scale(1);
                opacity: 1;
            }
        }
        
        .animate-next {
            animation: slideInNext 0.5s ease-out forwards;
        }

        .animate-prev {
            animation: slideInPrev 0.5s ease-out forwards;
        }

        .background-image {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            filter: blur(8px);
            transform: scale(1.1);
            z-index: -1;
            transition: background-image 0.5s ease-in-out;
        }

        .background-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(26, 32, 44, 0.7);
            z-index: -1;
        }
        
    </style>
</head>
<body>
    <div id="background-image-container" class="background-image"></div>
    <div id="background-overlay" class="background-overlay"></div>

    <div id="loading-message">Loading players...</div>

    <div id="auction-slide" class="glass-card rounded-2xl p-8 max-w-md w-full mx-4 flex flex-col items-center text-center hidden">
        <!-- Player Photo Section -->
        <div class="w-48 h-48 rounded-full bg-gray-700 flex items-center justify-center overflow-hidden border-4 border-yellow-400 mb-6 shadow-lg transition-transform duration-500 ease-in-out hover:scale-105">
            <img id="player-photo" src="https://placehold.co/192x192/2d3748/ffffff?text=Player" alt="Player Photo" class="w-full h-full object-cover">
        </div>

        <!-- Player Details Section -->
        <div class="w-full">
            <h1 id="player-name" class="text-4xl font-extrabold text-white mb-2 tracking-wide">Player Name</h1>
            <h2 id="player-position" class="text-xl text-yellow-400 font-semibold mb-2">Position</h2>
            <p id="player-batch" class="text-sm text-gray-400 uppercase tracking-widest font-medium">Batch</p>
        </div>
    </div>

    <script>
        let players = [];
        let currentPlayerIndex = 0;
        let isAnimating = false;

        const backgroundImageContainer = document.getElementById('background-image-container');

        // Function to update the auction slide content with a dynamic animation
        function updateSlide(player, direction = 'next') {
            if (isAnimating) return;
            isAnimating = true;

            const slide = document.getElementById('auction-slide');

            slide.classList.remove('animate-next', 'animate-prev');
            void slide.offsetWidth; // Trigger reflow to restart animation

            if (direction === 'next') {
                slide.classList.add('animate-next');
            } else {
                slide.classList.add('animate-prev');
            }

            slide.addEventListener('animationend', () => {
                isAnimating = false;
            }, { once: true });

            document.getElementById('player-photo').src = player.photo;
            document.getElementById('player-name').textContent = player.name;
            document.getElementById('player-position').textContent = player.position;
            document.getElementById('player-batch').textContent = player.batch;
            
            // Update the background image
            backgroundImageContainer.style.backgroundImage = `url('${player.photo}')`;

            // Add a fallback for broken image links
            document.getElementById('player-photo').onerror = function() {
                this.src = "https://placehold.co/192x192/2d3748/ffffff?text=Photo+Error";
            };
        }

        // Function to fetch and parse the CSV data
        async function fetchPlayers() {
            try {
                const loadingMessage = document.getElementById('loading-message');
                const slide = document.getElementById('auction-slide');

                // Show loading message and hide the slide
                loadingMessage.classList.remove('hidden');
                slide.classList.add('hidden');

                const response = await fetch('https://raw.githubusercontent.com/sonuk299/EPL/refs/heads/main/EPL%20(Responses)%20-%20Form%20responses%201.csv');
                const csvText = await response.text();
                
                // Simple CSV parsing
                const lines = csvText.split('\r\n').filter(line => line.trim() !== '');
                const headers = lines[0].split(',');
                const data = lines.slice(1);

                players = data.map(line => {
                    const values = line.split(',');
                    const imageUrl = values[4] ? values[4].trim() : '';

                    return {
                        name: values[1] ? values[1].trim() : "Unknown",
                        position: values[5] ? values[5].trim() : "Unknown",
                        batch: values[3] ? values[3].trim() : "Unknown",
                        photo: imageUrl
                    };
                });
                
                if (players.length > 0) {
                    // Hide loading message and show the slide
                    loadingMessage.classList.add('hidden');
                    slide.classList.remove('hidden');
                    updateSlide(players[currentPlayerIndex]);
                } else {
                    document.getElementById('loading-message').textContent = 'No player data found.';
                }

            } catch (error) {
                console.error('Error fetching or parsing CSV:', error);
                document.getElementById('loading-message').textContent = 'Failed to load player data.';
            }
        }

        // Event listeners for keyboard arrows
        document.addEventListener('keydown', (event) => {
            if (players.length === 0) return;
            if (event.key === 'ArrowRight') {
                currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
                updateSlide(players[currentPlayerIndex], 'next');
            } else if (event.key === 'ArrowLeft') {
                currentPlayerIndex = (currentPlayerIndex - 1 + players.length) % players.length;
                updateSlide(players[currentPlayerIndex], 'prev');
            }
        });

        // Fetch players on page load
        fetchPlayers();
    </script>
</body>
</html>
